{%extends 'admin/base.html'%}
{%block body%}
{%if current_user.is_authenticated%}
<h1>WELCOME {{current_user.name }} TO ADMINSTRATION WEBSITE!!!</h1>
<div class="row">
    <div class="col-md-6 col-xs-12">
        <table class="table">
            <tr>
                <th>Mã SP</th>
                <th>Tên SP</th>
                <th>Số lượng SP</th>
            </tr>
            {%for s in stats%}
            <tr>
                <td>{{s[0]}}</td>
                <td>{{s[1]}}</td>
                <td>{{s[2]}}</td>
            </tr>
            {%endfor%}
        </table>
    </div>
    <div class="col-md-6 col-xs-12">
        <canvas id="myCategoryChart"></canvas>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    let labels=[],info=[]
    {%for s in stats%}
        labels.push('{{s[1]}}')
        info.push({{s[2]}})
    {%endfor%}
    window.onload=function(){
        const ctx=document.getElementById('myCategoryChart').getContext('2d');
            new Chart(ctx, {
                type: 'pie',
                data: {
                  labels: labels,
                  datasets: [{
                    label: 'Thống Kê Số Sản Phẩm',
                    data: info,
                    borderWidth: 1
                  }]
                },
                options: {
                  scales: {
                    y: {
                      beginAtZero: true
                    }
                  }
                }
            });
    }

</script>
</div>

{%else%}
<h1 class=" text-center text-danger">Đăng Nhập Quản Trị</h1>
<form method='post' action="{{url_for('admin_login')}}">
            {%if err_msg%}
            <div class="alert alert-danger">
                <h4><b>{{err_msg}}</b></h4>

            </div>
            {%endif%}
              <div class="form-group">
                  <label for="username">Username</label>
                  <input type="text" class="form-control" placeholder="Enter username" name="username" id="username" required>
              </div>
              <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" class="form-control" placeholder="Enter password" name='password' id="password" required>
              </div>
              <div class="form-group form-check">
                <label class="form-check-label">
                  <input class="form-check-input" type="checkbox"> Remember me
                </label>
              </div>
              <button type="submit" class="btn btn-primary">Submit</button>
</form>

{%endif%}

{%endblock%}
